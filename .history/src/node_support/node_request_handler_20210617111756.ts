/*
 * Copyright 2017 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the
 * License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
 * express or implied. See the License for the specific language governing permissions and
 * limitations under the License.
 */

import { EventEmitter } from 'events';
import * as Http from 'http';
import * as Url from 'url';
import { AuthorizationRequest } from '../authorization_request';
import { AuthorizationRequestHandler, AuthorizationRequestResponse } from '../authorization_request_handler';
import { AuthorizationError, AuthorizationResponse } from '../authorization_response';
import { AuthorizationServiceConfiguration } from '../authorization_service_configuration';
import { Crypto } from '../crypto_utils';
import { log } from '../logger';
import { BasicQueryStringUtils, QueryStringUtils } from '../query_string_utils';
import { NodeCrypto } from './crypto_utils';


// TypeScript typings for `opener` are not correct and do not export it as module
import opener = require('opener');

class ServerEventsEmitter extends EventEmitter {
  static ON_UNABLE_TO_START = 'unable_to_start';
  static ON_AUTHORIZATION_RESPONSE = 'authorization_response';
}

export class NodeBasedHandler extends AuthorizationRequestHandler {
  // the handle to the current authorization request
  authorizationPromise: Promise<AuthorizationRequestResponse | null> | null = null;

  constructor(
    // default to port 8000
    public httpServerPort = 8000,
    utils: QueryStringUtils = new BasicQueryStringUtils(),
    crypto: Crypto = new NodeCrypto()) {
    super(utils, crypto);
  }

  performAuthorizationRequest(
    configuration: AuthorizationServiceConfiguration,
    request: AuthorizationRequest) {
    // use opener to launch a web browser and start the authorization flow.
    // start a web server to handle the authorization response.
    const emitter = new ServerEventsEmitter();

    const requestHandler = (httpRequest: Http.IncomingMessage, response: Http.ServerResponse) => {
      if (!httpRequest.url) {
        return;
      }

      const url = Url.parse(httpRequest.url);
      const searchParams = new Url.URLSearchParams(url.query || '');

      const state = searchParams.get('state') || undefined;
      const code = searchParams.get('code');
      const error = searchParams.get('error');

      if (!state && !code && !error) {
        // ignore irrelevant requests (e.g. favicon.ico)
        return;
      }

      log('Handling Authorization Request ', searchParams, state, code, error);
      let authorizationResponse: AuthorizationResponse | null = null;
      let authorizationError: AuthorizationError | null = null;
      if (error) {
        log('error');
        // get additional optional info.
        const errorUri = searchParams.get('error_uri') || undefined;
        const errorDescription = searchParams.get('error_description') || undefined;
        authorizationError = new AuthorizationError(
          { error: error, error_description: errorDescription, error_uri: errorUri, state: state });
      } else {
        authorizationResponse = new AuthorizationResponse({ code: code!, state: state! });
      }
      const completeResponse = {
        request,
        response: authorizationResponse,
        error: authorizationError
      } as AuthorizationRequestResponse;

      emitter.emit(ServerEventsEmitter.ON_AUTHORIZATION_RESPONSE, completeResponse);
      if (error) {

      } else {
        response.end(`<!DOCTYPE html><html><head> <title>Weave Successful login</title> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <link rel="shortcut icon" type="image/svg+xml" href="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Cdefs%3E%3Cstyle%3E.cls-1{fill:%234bc7e8;}%3C/style%3E%3C/defs%3E%3Cg id='Layer_2' data-name='Layer 2'%3E%3Cg id='Layer_1-2' data-name='Layer 1'%3E%3Cpath class='cls-1' d='M114,0h27c1.8,1.92,4.33,1.39,6.5,1.73A127.89,127.89,0,0,1,253.25,102.6c.85,4.14.51,8.56,2.75,12.4v27c-1.87,1.6-1.48,3.94-1.79,6-8,52.13-48.68,94.77-100.31,105.19-4.31.87-8.87.69-12.9,2.84H114c-1.6-1.88-3.94-1.49-6-1.8-52.12-8-94.78-48.72-105.2-100.35-.8-4-.4-8.26-2.83-11.85V115c1.88-1.82,1.4-4.34,1.74-6.52A127.75,127.75,0,0,1,108.54,1.74C110.39,1.45,112.61,1.88,114,0Zm29.59,100.2c1.18-.56,1.65-.73,2.06-1,17-10.51,35-1.34,36.17,18.58.39,6.81.22,13.66,0,20.48-.23,7.34-2.89,13.71-8.93,18.2-7,5.17-14.67,6.34-22.61,2.55-8.66-4.15-12.7-11.48-12.92-20.91-.19-8,.21-16-.26-24-1.2-20.46-19-37.4-39.52-38S58.39,91.48,56.14,111.93a143.84,143.84,0,0,0-.06,31.93c3.28,29.23,36.49,45.5,61.63,30.21,1.66-1,4.56-1.72,2.85-4.73-2.59-4.58-5.38-9-8.2-13.73l-3.13,1.9c-15.06,9.08-32.67.72-34.73-16.76a104.82,104.82,0,0,1,.29-27.41,20.56,20.56,0,0,1,8.68-14.08c6.9-5,14.42-6,22.19-2.37,8.51,4,12.66,11.14,13,20.34.32,7.82-.09,15.67.22,23.49.82,20.39,17.18,37.06,38,39,18.57,1.75,37.71-11.88,41.89-30.87a94.39,94.39,0,0,0-.09-42.17c-6.28-26.42-37.42-38.88-60.52-24.77-1.89,1.16-4.52,2-2.48,5.25C138.4,91.38,140.88,95.69,143.59,100.2Z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"/> <style> body { background-color: #f9fbfe; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100%25'%3E%3Cdefs%3E%3ClinearGradient id='a' gradientUnits='userSpaceOnUse' x1='0' x2='0' y1='0' y2='100%25' gradientTransform='rotate(240)'%3E%3Cstop offset='0' stop-color='%23f9fbfe'/%3E%3Cstop offset='1' stop-color='%2328caf4'/%3E%3C/linearGradient%3E%3Cpattern patternUnits='userSpaceOnUse' id='b' width='540' height='450' x='0' y='0' viewBox='0 0 1080 900'%3E%3Cg fill-opacity='0.1'%3E%3Cpolygon fill='%23444' points='90 150 0 300 180 300'/%3E%3Cpolygon points='90 150 180 0 0 0'/%3E%3Cpolygon fill='%23AAA' points='270 150 360 0 180 0'/%3E%3Cpolygon fill='%23DDD' points='450 150 360 300 540 300'/%3E%3Cpolygon fill='%23999' points='450 150 540 0 360 0'/%3E%3Cpolygon points='630 150 540 300 720 300'/%3E%3Cpolygon fill='%23DDD' points='630 150 720 0 540 0'/%3E%3Cpolygon fill='%23444' points='810 150 720 300 900 300'/%3E%3Cpolygon fill='%23FFF' points='810 150 900 0 720 0'/%3E%3Cpolygon fill='%23DDD' points='990 150 900 300 1080 300'/%3E%3Cpolygon fill='%23444' points='990 150 1080 0 900 0'/%3E%3Cpolygon fill='%23DDD' points='90 450 0 600 180 600'/%3E%3Cpolygon points='90 450 180 300 0 300'/%3E%3Cpolygon fill='%23666' points='270 450 180 600 360 600'/%3E%3Cpolygon fill='%23AAA' points='270 450 360 300 180 300'/%3E%3Cpolygon fill='%23DDD' points='450 450 360 600 540 600'/%3E%3Cpolygon fill='%23999' points='450 450 540 300 360 300'/%3E%3Cpolygon fill='%23999' points='630 450 540 600 720 600'/%3E%3Cpolygon fill='%23FFF' points='630 450 720 300 540 300'/%3E%3Cpolygon points='810 450 720 600 900 600'/%3E%3Cpolygon fill='%23DDD' points='810 450 900 300 720 300'/%3E%3Cpolygon fill='%23AAA' points='990 450 900 600 1080 600'/%3E%3Cpolygon fill='%23444' points='990 450 1080 300 900 300'/%3E%3Cpolygon fill='%23222' points='90 750 0 900 180 900'/%3E%3Cpolygon points='270 750 180 900 360 900'/%3E%3Cpolygon fill='%23DDD' points='270 750 360 600 180 600'/%3E%3Cpolygon points='450 750 540 600 360 600'/%3E%3Cpolygon points='630 750 540 900 720 900'/%3E%3Cpolygon fill='%23444' points='630 750 720 600 540 600'/%3E%3Cpolygon fill='%23AAA' points='810 750 720 900 900 900'/%3E%3Cpolygon fill='%23666' points='810 750 900 600 720 600'/%3E%3Cpolygon fill='%23999' points='990 750 900 900 1080 900'/%3E%3Cpolygon fill='%23999' points='180 0 90 150 270 150'/%3E%3Cpolygon fill='%23444' points='360 0 270 150 450 150'/%3E%3Cpolygon fill='%23FFF' points='540 0 450 150 630 150'/%3E%3Cpolygon points='900 0 810 150 990 150'/%3E%3Cpolygon fill='%23222' points='0 300 -90 450 90 450'/%3E%3Cpolygon fill='%23FFF' points='0 300 90 150 -90 150'/%3E%3Cpolygon fill='%23FFF' points='180 300 90 450 270 450'/%3E%3Cpolygon fill='%23666' points='180 300 270 150 90 150'/%3E%3Cpolygon fill='%23222' points='360 300 270 450 450 450'/%3E%3Cpolygon fill='%23FFF' points='360 300 450 150 270 150'/%3E%3Cpolygon fill='%23444' points='540 300 450 450 630 450'/%3E%3Cpolygon fill='%23222' points='540 300 630 150 450 150'/%3E%3Cpolygon fill='%23AAA' points='720 300 630 450 810 450'/%3E%3Cpolygon fill='%23666' points='720 300 810 150 630 150'/%3E%3Cpolygon fill='%23FFF' points='900 300 810 450 990 450'/%3E%3Cpolygon fill='%23999' points='900 300 990 150 810 150'/%3E%3Cpolygon points='0 600 -90 750 90 750'/%3E%3Cpolygon fill='%23666' points='0 600 90 450 -90 450'/%3E%3Cpolygon fill='%23AAA' points='180 600 90 750 270 750'/%3E%3Cpolygon fill='%23444' points='180 600 270 450 90 450'/%3E%3Cpolygon fill='%23444' points='360 600 270 750 450 750'/%3E%3Cpolygon fill='%23999' points='360 600 450 450 270 450'/%3E%3Cpolygon fill='%23666' points='540 600 630 450 450 450'/%3E%3Cpolygon fill='%23222' points='720 600 630 750 810 750'/%3E%3Cpolygon fill='%23FFF' points='900 600 810 750 990 750'/%3E%3Cpolygon fill='%23222' points='900 600 990 450 810 450'/%3E%3Cpolygon fill='%23DDD' points='0 900 90 750 -90 750'/%3E%3Cpolygon fill='%23444' points='180 900 270 750 90 750'/%3E%3Cpolygon fill='%23FFF' points='360 900 450 750 270 750'/%3E%3Cpolygon fill='%23AAA' points='540 900 630 750 450 750'/%3E%3Cpolygon fill='%23FFF' points='720 900 810 750 630 750'/%3E%3Cpolygon fill='%23222' points='900 900 990 750 810 750'/%3E%3Cpolygon fill='%23222' points='1080 300 990 450 1170 450'/%3E%3Cpolygon fill='%23FFF' points='1080 300 1170 150 990 150'/%3E%3Cpolygon points='1080 600 990 750 1170 750'/%3E%3Cpolygon fill='%23666' points='1080 600 1170 450 990 450'/%3E%3Cpolygon fill='%23DDD' points='1080 900 1170 750 990 750'/%3E%3C/g%3E%3C/pattern%3E%3C/defs%3E%3Crect x='0' y='0' fill='url(%23a)' width='100%25' height='100%25'/%3E%3Crect x='0' y='0' fill='url(%23b)' width='100%25' height='100%25'/%3E%3C/svg%3E"); background-attachment: fixed; background-size: cover; font-family: "Proxima Nova", sans-serif; } .success-card { width: 400px; height: 250px; background-color: white; position: absolute; display: flex; flex-direction: column; padding: 24px; left: 0; right: 0; top: 0; bottom: 0; margin: auto; max-width: 100%; max-height: 100%; overflow: auto; box-shadow: 0 4px 10px 0 rgba(49, 53, 61, 0.24); border-radius: 5%; background-image: url("data:image/png;base64,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"); background-repeat: no-repeat; background-position: 305px 34px; } .success-card-header { display: flex; justify-content: flex-start; align-items: center; width: 100%; } .success-card-body h2 { font-family: "Proxima Nova", sans-serif; font-weight: 400; } </style></head><body> <div class="success-card"> <div class="success-card-header"> <svg width="190px" height="51px" viewBox="0 0 170 31" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <title>Weave-Logo</title> <g id="WC-Form---Multi-Office" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Welcome-to-Weave-page-Copy-3" transform="translate(-48.000000, -28.000000)" fill="#29343C"> <g id="Weave-Logo" transform="translate(48.000000, 28.000000)"> <path d="M19.1940667,12.2762144 L19.1940667,18.543468 C19.1727682,25.2882197 24.6156774,30.8174551 31.4561187,31 C37.913358,30.9944221 43.2981032,26.1309761 43.8665019,19.7910706 C43.9653894,18.8602421 44,16.4673793 44,15.526804 C44,14.5862286 43.9653894,12.1933658 43.8665019,11.2625373 C43.4948374,6.83143707 40.7158695,2.94694178 36.606148,1.1138737 C32.4964264,-0.719194381 27.7015862,-0.212861221 24.07911,2.43672379 C23.970277,2.54880251 23.9598127,2.7220807 24.0543881,2.84609338 L26.6600742,7.10548656 C26.7021404,7.16605331 26.7687826,7.20566771 26.8427596,7.21408107 C26.9167366,7.22249443 26.9907806,7.19888018 27.0457355,7.14934759 L27.0457355,7.14934759 C28.944966,5.56918826 31.5645072,5.12916561 33.8875338,6.0000829 C36.2105605,6.87100018 37.8712482,8.91570755 38.2249691,11.3405125 C38.3665166,12.729737 38.4259495,14.1259016 38.4029666,15.5219305 C38.4246698,16.9047421 38.3685474,18.2876759 38.2348578,19.6643609 C37.7591096,22.9941499 34.8677038,25.4699079 31.4561187,25.468637 L31.4561187,25.468637 C29.679714,25.437506 27.9892001,24.7096121 26.7589617,23.4461563 C25.5108532,22.1846381 24.8148956,20.4907023 24.8207664,18.728659 L24.8207664,12.4614054 C24.8445622,5.70922813 19.3920755,0.174791116 12.5438813,0 C6.07794961,0.00668938926 0.68984191,4.88375171 0.133498146,11.2332967 C0.0296662546,12.1836189 0,14.5569879 0,15.5024367 C0,16.4478856 0.0296662546,18.8310014 0.133498146,19.7667033 C0.510485079,24.1927191 3.28821068,28.0710143 7.39330246,29.9029329 C11.4983942,31.7348514 16.2878804,31.2334638 19.9110012,28.5925169 C20.0167838,28.4772377 20.0270639,28.3049822 19.9357231,28.1782739 L17.3300371,23.9188807 C17.2879708,23.8583139 17.2213287,23.8186995 17.1473517,23.8102862 C17.0733747,23.8018728 16.9993307,23.8254871 16.9443758,23.8750197 L16.9443758,23.8750197 C15.0458858,25.4576592 12.42543,25.8998274 10.100943,25.0297608 C7.77645609,24.1596942 6.11431787,22.1145305 5.76019778,19.6887282 C5.62277556,18.2992393 5.56499936,16.9032149 5.58714462,15.5073102 C5.56543098,14.1228763 5.62155325,12.73832 5.7552534,11.3600063 C6.21686626,8.01602682 9.11009459,5.51998804 12.5339926,5.5118692 L12.5339926,5.5118692 C14.3103972,5.54300021 16.0009112,6.2708941 17.2311496,7.53434994 C18.4782048,8.79852387 19.1738692,10.493495 19.1693449,12.2567206 L19.1940667,12.2762144 Z" id="Path"></path> <polygon id="Path" points="73.5063996 26 77.9438338 26 85 5 80.4283993 5 75.6480952 19.6853147 70.6441801 5 66.360789 5 61.3022135 19.6853147 56.5765698 5 52 5 59.0611354 26 63.478693 26 68.5024846 11.4425897"></polygon> <polygon id="Path" points="136.408046 26 141.591954 26 150 5 145.496905 5 139.024315 21.0591022 132.507958 5 128 5"></polygon> <path d="M107.079059,17.809859 C107.499059,22.9620556 112.153647,27 117.336941,27 C119.516491,27.0015441 121.644902,26.3412071 123.439294,25.1067499 L123.671529,24.9391186 L124.476941,26.4182182 L128,26.4182182 C127.755722,25.2071504 127.628316,23.9755119 127.619529,22.7401907 L127.619529,14.0085733 C127.619529,8.49153216 122.861176,4 117.332,4 C112.148706,4 107.494118,8.03794165 107.074118,13.1901383 L107.074118,13.1901383 C107,13.9346183 107,14.7678444 107,15.3792055 L107,15.6207918 C107,16.2321529 107,17.065379 107.074118,17.809859 L107.079059,17.809859 Z M117.336941,23.0557319 C114.322824,23.0557319 111.531059,20.871595 111.071529,17.9331173 L111.071529,17.9331173 L111.036941,17.6471581 C110.973758,16.958802 110.947368,16.2675763 110.957882,15.5764188 L110.957882,15.4038572 C110.947368,14.7126997 110.973758,14.021474 111.036941,13.3331179 L111.071529,13.0471586 L111.071529,13.0471586 C111.531059,10.0889596 114.322824,7.92454402 117.336941,7.92454402 C120.351059,7.92454402 123.093412,10.1284023 123.552941,13.0570193 L123.552941,13.0570193 L123.582588,13.3429785 C123.645771,14.0313346 123.672162,14.7225604 123.661647,15.4137178 L123.661647,15.5862794 C123.672162,16.2774369 123.645771,16.9686626 123.582588,17.6570188 L123.552941,17.942978 L123.552941,17.942978 C123.093412,20.871595 120.321412,23.0557319 117.336941,23.0557319 Z" id="Shape" fill-rule="nonzero"></path> <path d="M105,14.2748124 C105,8.68874598 100.421335,4 95,4 C89.4793785,4.00543576 85.0053703,8.5340144 85,14.1219721 L85,16.8780279 C85,22.459164 89.6566001,27 95.2873843,27 C99.0197604,26.9978842 102.480373,25.024042 104.41549,21.7935691 L100.966878,19.9989282 C99.6994674,21.9181632 97.5680733,23.0690185 95.2873843,23.0655949 C92.3560278,23.0086698 89.8137326,20.9998454 89.047735,18.1352626 C89.0378734,18.048446 89.0378734,17.9607715 89.047735,17.873955 L104.922065,17.8197213 L105,14.2748124 Z M88.8918656,14.1022508 L88.8918656,13.6092176 C89.145058,10.4149822 91.7657354,7.94494086 94.9314977,7.91674235 C98.09726,7.88854385 100.760477,10.3115198 101.069167,13.5007503 L101.069167,14.0677385 L88.8918656,14.1022508 Z" id="Shape" fill-rule="nonzero"></path> <path d="M170,14.2748124 C170,8.68874598 165.420219,4 159.997564,4 C154.4775,4.00815216 150.005366,8.5359366 150,14.1219721 L150,16.8780279 C150,22.459164 154.652862,27 160.28989,27 C164.02144,26.9961624 167.48066,25.0225417 169.415347,21.7935691 L165.965895,19.9989282 C164.707197,21.9156123 162.583525,23.0669561 160.309379,23.0655949 C157.376161,23.0119442 154.831533,21.0017663 154.06821,18.1352626 C154.05595,18.0486018 154.05595,17.9606158 154.06821,17.873955 L169.951279,17.8197213 L170,14.2748124 Z M153.892814,14.1022508 L153.892814,13.6092176 C154.146068,10.4149822 156.767384,7.94494086 159.933917,7.91674235 C163.100451,7.88854385 165.764316,10.3115198 166.073082,13.5007503 L166.073082,14.0677385 L153.892814,14.1022508 Z" id="Shape" fill-rule="nonzero"></path> </g> </g> </g> </svg> </div> <div class="success-card-body"> <h2>Login Successful </h2> <p>You may close the browser now.</p> </div></div></body></html>
      `);
      }
    };

    this.authorizationPromise = new Promise<AuthorizationRequestResponse>((resolve, reject) => {
      emitter.once(ServerEventsEmitter.ON_UNABLE_TO_START, () => {
        reject(`Unable to create HTTP server at port ${this.httpServerPort}`);
      });
      emitter.once(ServerEventsEmitter.ON_AUTHORIZATION_RESPONSE, (result: any) => {
        server.close();
        // resolve pending promise
        resolve(result as AuthorizationRequestResponse);
        // complete authorization flow
        this.completeAuthorizationRequestIfPossible();
      });
    });

    let server: Http.Server;
    request.setupCodeVerifier()
      .then(() => {
        server = Http.createServer(requestHandler);
        server.listen(this.httpServerPort);
        const url = this.buildRequestUrl(configuration, request);
        log('Making a request to ', request, url);
        opener(url);
      })
      .catch((error) => {
        log('Something bad happened ', error);
        emitter.emit(ServerEventsEmitter.ON_UNABLE_TO_START);
      });
  }

  protected completeAuthorizationRequest(): Promise<AuthorizationRequestResponse | null> {
    if (!this.authorizationPromise) {
      return Promise.reject(
        'No pending authorization request. Call performAuthorizationRequest() ?');
    }

    return this.authorizationPromise;
  }
}
